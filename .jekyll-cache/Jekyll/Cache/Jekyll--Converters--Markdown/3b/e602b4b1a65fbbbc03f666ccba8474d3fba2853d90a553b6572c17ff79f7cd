I"†Ç<!-- 
<div class="imgcap">
<div >
<a href = "/2017/01/01/kmeans/">
    <img src ="/assets/kmeans/kmeans11.gif"  width = "800"></a>
</div>
<div class="thecap"> K-means Clustering <br></div>
</div> -->

<p><strong>Trong trang nÃ y:</strong>
<!-- MarkdownTOC --></p>

<ul>
  <li><a href="#-gioi-thieu">1. Giá»›i thiá»‡u</a></li>
  <li><a href="#-phan-tich-toan-hoc">2. PhÃ¢n tÃ­ch toÃ¡n há»c</a>
    <ul>
      <li><a href="#mot-so-ky-hieu-toan-hoc">Má»™t sá»‘ kÃ½ hiá»‡u toÃ¡n há»c</a></li>
      <li><a href="#ham-mat-mat-va-bai-toan-toi-uu">HÃ m máº¥t mÃ¡t vÃ  bÃ i toÃ¡n tá»‘i Æ°u</a></li>
      <li><a href="#thuat-toan-toi-uu-ham-mat-mat">Thuáº­t toÃ¡n tá»‘i Æ°u hÃ m máº¥t mÃ¡t</a>
        <ul>
          <li><a href="#co-dinh-\\\mathbfm-\\-tim-\\\mathbfy\\">Cá»‘ Ä‘á»‹nh \(\mathbf{M} \), tÃ¬m \(\mathbf{Y}\)</a></li>
          <li><a href="#co-dinh-\\\mathbfy-\\-tim-\\\mathbfm\\">Cá»‘ Ä‘á»‹nh \(\mathbf{Y} \), tÃ¬m \(\mathbf{M}\)</a></li>
        </ul>
      </li>
      <li><a href="#tom-tat-thuat-toan">TÃ³m táº¯t thuáº­t toÃ¡n</a></li>
    </ul>
  </li>
  <li><a href="#-vi-du-tren-python">3. VÃ­ dá»¥ trÃªn Python</a>
    <ul>
      <li><a href="#gioi-thieu-bai-toan">Giá»›i thiá»‡u bÃ i toÃ¡n</a></li>
      <li><a href="#hien-thi-du-lieu-tren-do-thi">Hiá»ƒn thá»‹ dá»¯ liá»‡u trÃªn Ä‘á»“ thá»‹</a></li>
      <li><a href="#cac-ham-so-can-thiet-cho-k-means-clustering">CÃ¡c hÃ m sá»‘ cáº§n thiáº¿t cho K-means clustering</a></li>
      <li><a href="#ket-qua-tim-duoc-bang-thu-vien-scikit-learn">Káº¿t quáº£ tÃ¬m Ä‘Æ°á»£c báº±ng thÆ° viá»‡n scikit-learn</a></li>
    </ul>
  </li>
  <li><a href="#-thao-luan">4. Tháº£o luáº­n</a>
    <ul>
      <li><a href="#han-che">Háº¡n cháº¿</a>
        <ul>
          <li><a href="#chung-ta-can-biet-so-luong-cluster-can-clustering">ChÃºng ta cáº§n biáº¿t sá»‘ lÆ°á»£ng cluster cáº§n clustering</a></li>
          <li><a href="#nghiem-cuoi-cung-phu-thuoc-vao-cac-centers-duoc-khoi-tao-ban-dau">Nghiá»‡m cuá»‘i cÃ¹ng phá»¥ thuá»™c vÃ o cÃ¡c centers Ä‘Æ°á»£c khá»Ÿi táº¡o ban Ä‘áº§u</a></li>
          <li><a href="#cac-cluster-can-co-so-luong-diem-gan-bang-nhau">CÃ¡c cluster cáº§n cÃ³ sÃ³ lÆ°á»£ng Ä‘iá»ƒm gáº§n báº±ng nhau</a></li>
          <li><a href="#cac-cluster-can-co-dang-hinh-tron">CÃ¡c cluster cáº§n cÃ³ dáº¡ng hÃ¬nh trÃ²n</a></li>
          <li><a href="#khi-mot-cluster-nam-phia-trong--cluster-khac">Khi má»™t cluster náº±m phÃ­a trong 1 cluster khÃ¡c</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#-tai-lieu-tham-khao">5. TÃ i liá»‡u tham kháº£o</a></li>
</ul>

<!-- /MarkdownTOC -->

<p><a name="-gioi-thieu"></a></p>

<h2 id="1-giá»›i-thiá»‡u">1. Giá»›i thiá»‡u</h2>

<p><a href="/2016/12/28/linearregression/">Trong bÃ i trÆ°á»›c</a>, chÃºng ta Ä‘Ã£ lÃ m quen vá»›i thuáº­t toÃ¡n Linear Regression - lÃ  thuáº­t toÃ¡n Ä‘Æ¡n giáº£n nháº¥t trong <a href="/2016/12/27/categories/#supervised-learning-hoc-co-giam-sat">Supervised learning</a>. BÃ i nÃ y tÃ´i sáº½ giá»›i thiá»‡u má»™t trong nhá»¯ng thuáº­t toÃ¡n cÆ¡ báº£n nháº¥t trong <a href="/2016/12/27/categories/#unsupervised-learning-hoc-khong-giam-sat">Unsupervised learning</a> - thuáº­t toÃ¡n K-means clustering (phÃ¢n cá»¥m K-means).</p>

<p>Trong thuáº­t toÃ¡n K-means clustering, chÃºng ta khÃ´ng biáº¿t nhÃ£n (label) cá»§a tá»«ng Ä‘iá»ƒm dá»¯ liá»‡u. Má»¥c Ä‘Ã­ch lÃ  lÃ m thá»ƒ nÃ o Ä‘á»ƒ phÃ¢n dá»¯ liá»‡u thÃ nh cÃ¡c cá»¥m (cluster) khÃ¡c nhau sao cho <em>dá»¯ liá»‡u trong cÃ¹ng má»™t cá»¥m cÃ³ tÃ­nh cháº¥t giá»‘ng nhau</em>.</p>

<p><strong>VÃ­ dá»¥:</strong> Má»™t cÃ´ng ty muá»‘n táº¡o ra nhá»¯ng chÃ­nh sÃ¡ch Æ°u Ä‘Ã£i cho nhá»¯ng nhÃ³m khÃ¡ch hÃ ng khÃ¡c nhau dá»±a trÃªn sá»± tÆ°Æ¡ng tÃ¡c giá»¯a má»—i khÃ¡ch hÃ ng vá»›i cÃ´ng ty Ä‘Ã³ (sá»‘ nÄƒm lÃ  khÃ¡ch hÃ ng; sá»‘ tiá»n khÃ¡ch hÃ ng Ä‘Ã£ chi tráº£ cho cÃ´ng ty; Ä‘á»™ tuá»•i; giá»›i tÃ­nh; thÃ nh phá»‘; nghá» nghiá»‡p; â€¦). Giáº£ sá»­ cÃ´ng ty Ä‘Ã³ cÃ³ ráº¥t nhiá»u dá»¯ liá»‡u cá»§a ráº¥t nhiá»u khÃ¡ch hÃ ng nhÆ°ng chÆ°a cÃ³ cÃ¡ch nÃ o chia toÃ n bá»™ khÃ¡ch hÃ ng Ä‘Ã³ thÃ nh má»™t sá»‘ nhÃ³m/cá»¥m khÃ¡c nhau. Náº¿u má»™t ngÆ°á»i biáº¿t Machine Learning Ä‘Æ°á»£c Ä‘áº·t cÃ¢u há»i nÃ y, phÆ°Æ¡ng phÃ¡p Ä‘áº§u tiÃªn anh (chá»‹) ta nghÄ© Ä‘áº¿n sáº½ lÃ  K-means Clustering. VÃ¬ nÃ³ lÃ  má»™t trong nhá»¯ng thuáº­t toÃ¡n Ä‘áº§u tiÃªn mÃ  anh áº¥y tÃ¬m Ä‘Æ°á»£c trong cÃ¡c cuá»‘n sÃ¡ch, khÃ³a há»c vá» Machine Learning. VÃ  tÃ´i cÅ©ng cháº¯c ráº±ng anh áº¥y Ä‘Ã£ Ä‘á»c blog <a href="https://tiepvupsu.github.io">Machine Learning cÆ¡ báº£n</a>. Sau khi Ä‘Ã£ phÃ¢n ra Ä‘Æ°á»£c tá»«ng nhÃ³m, nhÃ¢n viÃªn cÃ´ng ty Ä‘Ã³ cÃ³ thá»ƒ lá»±a chá»n ra má»™t vÃ i khÃ¡ch hÃ ng trong má»—i nhÃ³m Ä‘á»ƒ quyáº¿t Ä‘á»‹nh xem má»—i nhÃ³m tÆ°Æ¡ng á»©ng vá»›i nhÃ³m khÃ¡ch hÃ ng nÃ o. Pháº§n viá»‡c cuá»‘i cÃ¹ng nÃ y cáº§n sá»± can thiá»‡p cá»§a con ngÆ°á»i, nhÆ°ng lÆ°á»£ng cÃ´ng viá»‡c Ä‘Ã£ Ä‘Æ°á»£c rÃºt gá»n Ä‘i ráº¥t nhiá»u.</p>

<p>Ã tÆ°á»Ÿng Ä‘Æ¡n giáº£n nháº¥t vá» cluster (cá»¥m) lÃ  táº­p há»£p cÃ¡c Ä‘iá»ƒm <em>á»Ÿ gáº§n nhau trong má»™t khÃ´ng gian nÃ o Ä‘Ã³</em> (khÃ´ng gian nÃ y cÃ³ thá»ƒ cÃ³ ráº¥t nhiá»u chiá»u trong trÆ°á»ng há»£p thÃ´ng tin vá» má»™t Ä‘iá»ƒm dá»¯ liá»‡u lÃ  ráº¥t lá»›n). HÃ¬nh bÃªn dÆ°á»›i lÃ  má»™t vÃ­ dá»¥ vá» 3 cá»¥m dá»¯ liá»‡u (tá»« giá» tÃ´i sáº½ viáº¿t gá»n lÃ  <em>cluster</em>).</p>

<div class="imgcap">
<img src="/assets/kmeans/figure_2.png" width="500" align="center" />
<div class="thecap"> BÃ i toÃ¡n vá»›i 3 clusters. <br /></div>
</div>

<p>Giáº£ sá»­ má»—i cluster cÃ³ má»™t Ä‘iá»ƒm Ä‘áº¡i diá»‡n (<em>center</em>) mÃ u vÃ ng. VÃ  nhá»¯ng Ä‘iá»ƒm xung quanh má»—i center thuá»™c vÃ o cÃ¹ng nhÃ³m vá»›i center Ä‘Ã³. Má»™t cÃ¡ch Ä‘Æ¡n giáº£n nháº¥t, xÃ©t má»™t Ä‘iá»ƒm báº¥t ká»³, ta xÃ©t xem Ä‘iá»ƒm Ä‘Ã³ gáº§n vá»›i center nÃ o nháº¥t thÃ¬ nÃ³ thuá»™c vá» cÃ¹ng nhÃ³m vá»›i center Ä‘Ã³. Tá»›i Ä‘Ã¢y, chÃºng ta cÃ³ má»™t bÃ i toÃ¡n thÃº vá»‹: <em>TrÃªn má»™t vÃ¹ng biá»ƒn hÃ¬nh vuÃ´ng lá»›n cÃ³ ba Ä‘áº£o hÃ¬nh vuÃ´ng, tam giÃ¡c, vÃ  trÃ²n mÃ u vÃ ng nhÆ° hÃ¬nh trÃªn. Má»™t Ä‘iá»ƒm trÃªn biá»ƒn Ä‘Æ°á»£c gá»i lÃ  thuá»™c lÃ£nh háº£i cá»§a má»™t Ä‘áº£o náº¿u nÃ³ náº±m gáº§n Ä‘áº£o nÃ y hÆ¡n so vá»›i hai Ä‘áº£o kia . HÃ£y xÃ¡c Ä‘á»‹nh ranh giá»›i lÃ£nh háº£i cá»§a cÃ¡c Ä‘áº£o.</em></p>

<p>HÃ¬nh dÆ°á»›i Ä‘Ã¢y lÃ  má»™t hÃ¬nh minh há»a cho viá»‡c phÃ¢n chia lÃ£nh háº£i náº¿u cÃ³ 5 Ä‘áº£o khÃ¡c nhau Ä‘Æ°á»£c biá»ƒu diá»…n báº±ng cÃ¡c hÃ¬nh trÃ²n mÃ u Ä‘en:</p>
<div class="imgcap">
<img src="/assets/kmeans/figure_1.png" width="500" align="center" />
<div class="thecap"> PhÃ¢n vÃ¹ng lÃ£nh háº£i cá»§a má»—i Ä‘áº£o. CÃ¡c vÃ¹ng khÃ¡c nhau cÃ³ mÃ u sáº¯c khÃ¡c nhau. <br /></div>
</div>

<p>ChÃºng ta tháº¥y ráº±ng Ä‘Æ°á»ng phÃ¢n Ä‘á»‹nh giá»¯a cÃ¡c lÃ£nh háº£i lÃ  cÃ¡c Ä‘Æ°á»ng tháº³ng (chÃ­nh xÃ¡c hÆ¡n thÃ¬ chÃºng lÃ  cÃ¡c Ä‘Æ°á»ng trung trá»±c cá»§a cÃ¡c cáº·p Ä‘iá»ƒm gáº§n nhau). VÃ¬ váº­y, lÃ£nh háº£i cá»§a má»™t Ä‘áº£o sáº½ lÃ  má»™t hÃ¬nh Ä‘a giÃ¡c.</p>

<p>CÃ¡ch phÃ¢n chia nÃ y trong toÃ¡n há»c Ä‘Æ°á»£c gá»i lÃ  <a href="https://en.wikipedia.org/wiki/Voronoi_diagram">Voronoi Diagram</a>.</p>

<p>Trong khÃ´ng gian ba chiá»u, láº¥y vÃ­ dá»¥ lÃ  cÃ¡c hÃ nh tinh, thÃ¬ (táº¡m gá»i lÃ ) <em>lÃ£nh khÃ´ng</em> cá»§a má»—i hÃ nh tinh sáº½ lÃ  má»™t Ä‘a diá»‡n. Trong khÃ´ng gian nhiá»u chiá»u hÆ¡n, chÃºng ta sáº½ cÃ³ nhá»¯ng thá»© (mÃ  tÃ´i gá»i lÃ ) <em>siÃªu Ä‘a diá»‡n</em> (hyperpolygon).</p>

<p>Quay láº¡i vá»›i bÃ i toÃ¡n phÃ¢n nhÃ³m vÃ  cá»¥ thá»ƒ lÃ  thuáº­t toÃ¡n K-means clustering, chÃºng ta cáº§n má»™t chÃºt phÃ¢n tÃ­ch toÃ¡n há»c trÆ°á»›c khi Ä‘i tá»›i pháº§n <a href="#tom-tat-thuat-toan">tÃ³m táº¯t thuáº­t toÃ¡n</a> á»Ÿ pháº§n dÆ°á»›i. Náº¿u báº¡n khÃ´ng muá»‘n Ä‘á»c quÃ¡ nhiá»u vá» toÃ¡n, báº¡n cÃ³ thá»ƒ bá» qua pháº§n nÃ y. (<em>Tá»‘t nháº¥t lÃ  Ä‘á»«ng bá» qua, báº¡n sáº½ tiáº¿c Ä‘áº¥y</em>).
<!-- ========================== New Heading ==================== -->
<a name="-phan-tich-toan-hoc"></a></p>

<h2 id="2-phÃ¢n-tÃ­ch-toÃ¡n-há»c">2. PhÃ¢n tÃ­ch toÃ¡n há»c</h2>

<p>Má»¥c Ä‘Ã­ch cuá»‘i cÃ¹ng cá»§a thuáº­t toÃ¡n phÃ¢n nhÃ³m nÃ y lÃ : tá»« dá»¯ liá»‡u Ä‘áº§u vÃ o vÃ  sá»‘ lÆ°á»£ng nhÃ³m chÃºng ta muá»‘n tÃ¬m, hÃ£y chá»‰ ra center cá»§a má»—i nhÃ³m vÃ  phÃ¢n cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u vÃ o cÃ¡c nhÃ³m tÆ°Æ¡ng á»©ng. Giáº£ sá»­ thÃªm ráº±ng má»—i Ä‘iá»ƒm dá»¯ liá»‡u chá»‰ thuá»™c vÃ o Ä‘Ãºng má»™t nhÃ³m.</p>

<p><a name="mot-so-ky-hieu-toan-hoc"></a></p>

<h3 id="má»™t-sá»‘-kÃ½-hiá»‡u-toÃ¡n-há»c">Má»™t sá»‘ kÃ½ hiá»‡u toÃ¡n há»c</h3>
<p>Giáº£ sá»­ cÃ³ \(N\) Ä‘iá»ƒm dá»¯ liá»‡u lÃ  \( \mathbf{X} = [\mathbf{x}_1, \mathbf{x}_2, \dots, \mathbf{x}_N] \in \mathbb{R}^{d \times N}\) vÃ  \(K &lt; N\) lÃ  sá»‘ cluster chÃºng ta muá»‘n phÃ¢n chia. ChÃºng ta cáº§n tÃ¬m cÃ¡c center \( \mathbf{m}_1, \mathbf{m}_2, \dots, \mathbf{m}_K \in \mathbb{R}^{d \times 1} \) vÃ  label cá»§a má»—i Ä‘iá»ƒm dá»¯ liá»‡u.</p>

<p><strong>LÆ°u Ã½ vá» kÃ½ hiá»‡u toÃ¡n há»c:</strong> <em>trong cÃ¡c bÃ i viáº¿t cá»§a tÃ´i, cÃ¡c sá»‘ vÃ´ hÆ°á»›ng Ä‘Æ°á»£c biá»ƒu diá»…n bá»Ÿi cÃ¡c chá»¯ cÃ¡i viáº¿t á»Ÿ dáº¡ng khÃ´ng in Ä‘áº­m, cÃ³ thá»ƒ viáº¿t hoa, vÃ­ dá»¥ \(x_1, N, y, k\). CÃ¡c vector Ä‘Æ°á»£c biá»ƒu diá»…n báº±ng cÃ¡c chá»¯ cÃ¡i thÆ°á»ng in Ä‘áº­m, vÃ­ dá»¥ \(\mathbf{m}, \mathbf{x}_1 \). CÃ¡c ma tráº­n Ä‘Æ°á»£c biá»ƒu diá»…n bá»Ÿi cÃ¡c chá»¯ viáº¿t hoa in Ä‘áº­m, vÃ­ dá»¥ \(\mathbf{X, M, Y} \). LÆ°u Ã½ nÃ y Ä‘Ã£ Ä‘Æ°á»£c nÃªu á»Ÿ bÃ i <a href="/2016/12/28/linearregression/">Linear Regression</a>. TÃ´i xin Ä‘Æ°á»£c khÃ´ng nháº¯c láº¡i trong cÃ¡c bÃ i tiáº¿p theo.</em></p>

<p><a name="one-hot"></a>
Vá»›i má»—i Ä‘iá»ƒm dá»¯ liá»‡u \( \mathbf{x}_i \) Ä‘áº·t \(\mathbf{y}_i = [y_{i1}, y_{i2}, \dots, y_{iK}]\) lÃ  label vector cá»§a nÃ³, trong Ä‘Ã³ náº¿u \( \mathbf{x}_i \) Ä‘Æ°á»£c phÃ¢n vÃ o cluster \(k\) thÃ¬  \(y_{ik} = 1\) vÃ  \(y_{ij} = 0, \forall j \neq k \). Äiá»u nÃ y cÃ³ nghÄ©a lÃ  cÃ³ Ä‘Ãºng má»™t pháº§n tá»­ cá»§a vector \(\mathbf{y}_i\) lÃ  báº±ng 1 (tÆ°Æ¡ng á»©ng vá»›i cluster cá»§a \(\mathbf{x}_i \)), cÃ¡c pháº§n tá»­ cÃ²n láº¡i báº±ng 0. VÃ­ dá»¥: náº¿u má»™t Ä‘iá»ƒm dá»¯ liá»‡u cÃ³ label vector lÃ  \([1,0,0,\dots,0]\) thÃ¬ nÃ³ thuá»™c vÃ o cluster 1, lÃ  \([0,1,0,\dots,0]\) thÃ¬ nÃ³ thuá»™c vÃ o cluster 2, \(\dots\). CÃ¡ch mÃ£ hÃ³a label cá»§a dá»¯ liá»‡u nhÆ° tháº¿ nÃ y Ä‘Æ°á»£c goi lÃ  biá»ƒu diá»…n <a href="https://en.wikipedia.org/wiki/One-hot"><em>one-hot</em></a>. ChÃºng ta sáº½ tháº¥y cÃ¡ch biá»ƒu diá»…n one-hot nÃ y ráº¥t phá»• biáº¿n trong Machine Learning á»Ÿ cÃ¡c bÃ i tiáº¿p theo.</p>

<p>RÃ ng buá»™c cá»§a \(\mathbf{y}_i \) cÃ³ thá»ƒ viáº¿t dÆ°á»›i dáº¡ng toÃ¡n há»c nhÆ° sau:
\[
 y_{ik} \in \{0, 1\},~~~ \sum_{k = 1}^K y_{ik} = 1 ~~~ (1)
\]
<!-- \\[ \mathbf{y}_i = [y_{i}, y_2] \\] -->
<!-- [y_{i1}]\\) -->
<!-- Ä‘áº·t \\(\mathbf{y}_i = [y_{i1}, y_{i2}, \dots, y_{iK} \\) lÃ  vector biá»ƒu diá»…n label cá»§a má»™t Ä‘iá»ƒm, trong Ä‘Ã³ náº¿u náº¿u Ä‘iá»ƒm dá»¯ liá»‡u --></p>

<p><!-- \\(\mathbf{x}_i\\) Ä‘Æ°á»£c phÃ¢n vÃ o cluster \\(k\\) thÃ¬  \\(y_{ik} = 1\\)  -->
<!-- ========================== New Heading ==================== -->
<a name="ham-mat-mat-va-bai-toan-toi-uu"></a></p>

<h3 id="hÃ m-máº¥t-mÃ¡t-vÃ -bÃ i-toÃ¡n-tá»‘i-Æ°u">HÃ m máº¥t mÃ¡t vÃ  bÃ i toÃ¡n tá»‘i Æ°u</h3>

<p>Náº¿u ta coi center \(\mathbf{m}_k \)  lÃ  center (hoáº·c representative) cá»§a má»—i cluster vÃ  <em>Æ°á»›c lÆ°á»£ng</em> táº¥t cáº£ cÃ¡c Ä‘iá»ƒm Ä‘Æ°á»£c phÃ¢n vÃ o cluster nÃ y bá»Ÿi \(\mathbf{m}_k \), thÃ¬ má»™t Ä‘iá»ƒm dá»¯ liá»‡u \(\mathbf{x}_i \) Ä‘Æ°á»£c phÃ¢n vÃ o cluster \(k\) sáº½ bá»‹ sai sá»‘ lÃ  \( (\mathbf{x}_i - \mathbf{m}_k) \). ChÃºng ta mong muá»‘n sai sá»‘ nÃ y cÃ³ trá»‹ tuyá»‡t Ä‘á»‘i nhá» nháº¥t nÃªn (<a href="/2016/12/28/linearregression/#sai-so-du-doan">giá»‘ng nhÆ° trong bÃ i Linear Regression</a>) ta sáº½ tÃ¬m cÃ¡ch Ä‘á»ƒ Ä‘áº¡i lÆ°á»£ng sau Ä‘Ã¢y Ä‘áº¡t giÃ¡ trá»‹ nhá» nháº¥t: 
\[
\|\mathbf{x}_i - \mathbf{m}_k\|_2^2
\]</p>

<p>HÆ¡n ná»¯a, vÃ¬ \(\mathbf{x}_i \) Ä‘Æ°á»£c phÃ¢n vÃ o cluster \(k\) nÃªn \(y_{ik} = 1, y_{ij} = 0, ~\forall j \neq k \). Khi Ä‘Ã³, biá»ƒu thá»©c bÃªn trÃªn sáº½ Ä‘Æ°á»£c viáº¿t láº¡i lÃ :
\[
y_{ik}\|\mathbf{x}_i - \mathbf{m}_k\|_2^2 =  \sum_{j=1}^K y_{ij}\|\mathbf{x}_i - \mathbf{m}_j\|_2^2
\]</p>

<p>(<em>Hy vá»ng chá»— nÃ y khÃ´ng quÃ¡ khÃ³ hiá»ƒu</em>)</p>

<!-- Vá»›i má»—i Ä‘iá»ƒm dá»¯ liá»‡u \\(\mathbf{x}\_i \\), vÃ¬ chÆ°a biáº¿t nÃ³ thuá»™c cluster nÃ o, (_á»Ÿ Ä‘Ã¢y chÃºng ta táº¡m thá»i giáº£ sá»­ ráº±ng ta Ä‘Ã£ biáº¿t cÃ¡c center_), tháº¿ thÃ¬ hÃ m máº¥t mÃ¡t cá»§a cÃ¡ch phÃ¢n cá»¥m cho Ä‘iá»ƒm \\(\mathbf{x}\_i \\) sáº½ lÃ : -->

<!-- \\[
\sum\_{k=1}^K y\_{ik} \\\|\mathbf{x}\_i - \mathbf{m}\_k \\|_2^2
\\]
 -->

<p>Sai sá»‘ cho toÃ n bá»™ dá»¯ liá»‡u sáº½ lÃ : 
\[
\mathcal{L}(\mathbf{Y}, \mathbf{M}) = \sum_{i=1}^N\sum_{j=1}^K y_{ij} \|\mathbf{x}_i - \mathbf{m}_j\|_2^2
\]</p>

<p>Trong Ä‘Ã³ \( \mathbf{Y} = [\mathbf{y}_1; \mathbf{y}_2; \dots; \mathbf{y}_N]\), \( \mathbf{M} = [\mathbf{m}_1, \mathbf{m}_2, \dots \mathbf{m}_K] \) láº§n lÆ°á»£t lÃ  cÃ¡c ma tráº­n Ä‘Æ°á»£c táº¡o bá»Ÿi label vector cá»§a má»—i Ä‘iá»ƒm dá»¯ liá»‡u vÃ  center cá»§a má»—i cluster. HÃ m sá»‘ máº¥t mÃ¡t trong bÃ i toÃ¡n K-means clustering cá»§a chÃºng ta lÃ  hÃ m \(\mathcal{L}(\mathbf{Y}, \mathbf{M})\) vá»›i rÃ ng buá»™c nhÆ° Ä‘Æ°á»£c nÃªu trong phÆ°Æ¡ng trÃ¬nh \((1)\).</p>

<p>TÃ³m láº¡i, chÃºng ta cáº§n tá»‘i Æ°u bÃ i toÃ¡n sau: 
\[
\mathbf{Y}, \mathbf{M} = \arg\min_{\mathbf{Y}, \mathbf{M}} \sum_{i=1}^N\sum_{j=1}^K y_{ij} \|\mathbf{x}_i - \mathbf{m}_j\|_2^2~~~~~(2)
\]</p>

<p>\[
\text{subject to:} ~~ y_{ij} \in \{0, 1\}~~ \forall i, j;~~~ \sum_{j = 1}^K y_{ij} = 1~~\forall i
\]</p>

<p>(<em>subject to</em> nghÄ©a lÃ  <em>thá»a mÃ£n Ä‘iá»u kiá»‡n</em>).</p>

<p><strong>Nháº¯c láº¡i khÃ¡i niá»‡m \(\arg\min\)</strong>: ChÃºng ta biáº¿t kÃ½ hiá»‡u \(\min\) lÃ  <em>giÃ¡ trá»‹ nhá» nháº¥t cá»§a hÃ m sá»‘</em>, \(\arg\min\) chÃ­nh lÃ  <em>giÃ¡ trá»‹ cá»§a biáº¿n sá»‘ Ä‘á»ƒ hÃ m sá»‘ Ä‘Ã³ Ä‘áº¡t giÃ¡ trá»‹ nhá» nháº¥t Ä‘Ã³</em>. Náº¿u \(f(x) = x^2 -2x + 1 = (x-1)^2 \) thÃ¬ giÃ¡ trá»‹ nhá» nháº¥t cá»§a hÃ m sá»‘ nÃ y báº±ng 0, Ä‘áº¡t Ä‘Æ°á»£c khi \(x = 1\). Trong vÃ­ dá»¥ nÃ y \(\min_{x} f(x) = 0\) vÃ  \(\arg\min_{x} f(x) = 1\). ThÃªm vÃ­ dá»¥ khÃ¡c, náº¿u \(x_1 = 0, x_2 = 10, x_3 = 5\) thÃ¬ ta nÃ³i \(\arg\min_{i} x_i = 1\) vÃ¬ \(1\) lÃ  chá»‰ sá»‘ Ä‘á»ƒ \(x_i\) Ä‘áº¡t giÃ¡ trá»‹ nhá» nháº¥t (báº±ng \(0\)). Biáº¿n sá»‘ viáº¿t bÃªn dÆ°á»›i \(\min\) lÃ  biáº¿n sá»‘ cÃºng ta cáº§n tá»‘i Æ°u. Trong cÃ¡c bÃ i toÃ¡n tá»‘i Æ°u, ta thÆ°á»ng quan tÃ¢m tá»›i \(\arg\min\) hÆ¡n lÃ  \(\min\).
<!-- _K-means cÃ²n lÃ  má»™t trong nhá»¯ng phÆ°Æ¡ng phÃ¡p thá»±c hiá»‡n Æ°á»›c lÆ°á»£ng vector [_vector quantization_](https://en.wikipedia.org/wiki/Vector_quantization)_ -->
<!-- ========================== New Heading ==================== -->
<a name="thuat-toan-toi-uu-ham-mat-mat"></a></p>

<h3 id="thuáº­t-toÃ¡n-tá»‘i-Æ°u-hÃ m-máº¥t-mÃ¡t">Thuáº­t toÃ¡n tá»‘i Æ°u hÃ m máº¥t mÃ¡t</h3>
<p>BÃ i toÃ¡n \((2)\) lÃ  má»™t bÃ i toÃ¡n khÃ³ tÃ¬m <em>Ä‘iá»ƒm tá»‘i Æ°u</em> vÃ¬ nÃ³ cÃ³ thÃªm cÃ¡c Ä‘iá»u kiá»‡n rÃ ng buá»™c. <em>BÃ i toÃ¡n nÃ y thuá»™c loáº¡i mix-integer programming (Ä‘iá»u kiá»‡n biáº¿n lÃ  sá»‘ nguyÃªn) - lÃ  loáº¡i ráº¥t khÃ³ tÃ¬m nghiá»‡m tá»‘i Æ°u toÃ n cá»¥c (global optimal point, tá»©c nghiá»‡m lÃ m cho hÃ m máº¥t mÃ¡t Ä‘áº¡t giÃ¡ trá»‹ nhá» nháº¥t cÃ³ thá»ƒ).</em> Tuy nhiÃªn, trong má»™t sá»‘ trÆ°á»ng há»£p chÃºng ta váº«n cÃ³ thá»ƒ tÃ¬m Ä‘Æ°á»£c phÆ°Æ¡ng phÃ¡p Ä‘á»ƒ tÃ¬m Ä‘Æ°á»£c nghiá»‡m gáº§n Ä‘Ãºng hoáº·c Ä‘iá»ƒm cá»±c tiá»ƒu. (<em>Náº¿u chÃºng ta váº«n nhá»› chÆ°Æ¡ng trÃ¬nh toÃ¡n Ã´n thi Ä‘áº¡i há»c thÃ¬ Ä‘iá»ƒm cá»±c tiá»ƒu chÆ°a cháº¯c Ä‘Ã£ pháº£i lÃ  Ä‘iá»ƒm lÃ m cho hÃ m sá»‘ Ä‘áº¡t giÃ¡ trá»‹ nhá» nháº¥t</em>).</p>

<p>Má»™t cÃ¡ch Ä‘Æ¡n giáº£n Ä‘á»ƒ giáº£i bÃ i toÃ¡n \((2)\) lÃ  xen káº½ giáº£i \(\mathbf{Y}\) vÃ  \( \mathbf{M}\) khi biáº¿n cÃ²n láº¡i Ä‘Æ°á»£c cá»‘ Ä‘á»‹nh. ÄÃ¢y lÃ  má»™t thuáº­t toÃ¡n láº·p, cÅ©ng lÃ  ká»¹ thuáº­t phá»• biáº¿n khi giáº£i bÃ i toÃ¡n tá»‘i Æ°u. ChÃºng ta sáº½ láº§n lÆ°á»£t giáº£i quyáº¿t hai bÃ i toÃ¡n sau Ä‘Ã¢y:</p>

<!-- ========================== New Heading ==================== -->
<p><a name="co-dinh-\\\mathbfm-\\-tim-\\\mathbfy\\"></a></p>

<h4 id="cá»‘-Ä‘á»‹nh-mathbfm--tÃ¬m-mathbfy">Cá»‘ Ä‘á»‹nh \(\mathbf{M} \), tÃ¬m \(\mathbf{Y}\)</h4>
<p><strong>Giáº£ sá»­ Ä‘Ã£ tÃ¬m Ä‘Æ°á»£c cÃ¡c centers, hÃ£y tÃ¬m cÃ¡c label vector Ä‘á»ƒ hÃ m máº¥t mÃ¡t Ä‘áº¡t giÃ¡ trá»‹ nhá» nháº¥t.</strong> Äiá»u nÃ y tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i viá»‡c tÃ¬m cluster cho má»—i Ä‘iá»ƒm dá»¯ liá»‡u.</p>

<p>Khi cÃ¡c centers lÃ  cá»‘ Ä‘á»‹nh, bÃ i toÃ¡n tÃ¬m label vector cho toÃ n bá»™ dá»¯ liá»‡u cÃ³ thá»ƒ Ä‘Æ°á»£c chia nhá» thÃ nh bÃ i toÃ¡n tÃ¬m label vector cho tá»«ng Ä‘iá»ƒm dá»¯ liá»‡u \(\mathbf{x}_i\) nhÆ° sau:</p>

<p>\[
\mathbf{y}_i = \arg\min_{\mathbf{y}_i} \sum_{j=1}^K y_{ij}\|\mathbf{x}_i - \mathbf{m}_j\|_2^2 ~~~ (3)
\]
\[
\text{subject to:} ~~ y_{ij} \in \{0, 1\}~~ \forall j;~~~ \sum_{j = 1}^K y_{ij} = 1
\]</p>

<p>VÃ¬ chá»‰ cÃ³ má»™t pháº§n tá»­ cá»§a label vector \(\mathbf{y}_i\) báº±ng \(1\) nÃªn bÃ i toÃ¡n \((3)\) cÃ³ thá»ƒ tiáº¿p tá»¥c Ä‘Æ°á»£c viáº¿t dÆ°á»›i dáº¡ng Ä‘Æ¡n giáº£n hÆ¡n: 
\[
j = \arg\min_{j} \|\mathbf{x}_i - \mathbf{m}_j\|_2^2
\]</p>

<p>VÃ¬ \(\|\mathbf{x}_i - \mathbf{m}_j\|_2^2\) chÃ­nh lÃ  bÃ¬nh phÆ°Æ¡ng khoáº£ng cÃ¡ch tÃ­nh tá»« Ä‘iá»ƒm \(\mathbf{x}_i \) tá»›i center \(\mathbf{m}_j \), ta cÃ³ thá»ƒ káº¿t luáº­n ráº±ng <strong>má»—i Ä‘iá»ƒm \(\mathbf{x}_i \) thuá»™c vÃ o cluster cÃ³ center gáº§n nÃ³ nháº¥t</strong>! Tá»« Ä‘Ã³ ta cÃ³ thá»ƒ dá»… dÃ ng suy ra label vector cá»§a tá»«ng Ä‘iá»ƒm dá»¯ liá»‡u.</p>

<!-- ========================== New Heading ==================== -->
<p><a name="co-dinh-\\\mathbfy-\\-tim-\\\mathbfm\\"></a></p>

<h4 id="cá»‘-Ä‘á»‹nh-mathbfy--tÃ¬m-mathbfm">Cá»‘ Ä‘á»‹nh \(\mathbf{Y} \), tÃ¬m \(\mathbf{M}\)</h4>
<p><strong>Giáº£ sá»­ Ä‘Ã£ tÃ¬m Ä‘Æ°á»£c cluster cho tá»«ng Ä‘iá»ƒm, hÃ£y tÃ¬m center má»›i cho má»—i cluster Ä‘á»ƒ hÃ m máº¥t mÃ¡t Ä‘áº¡t giÃ¡ trá»‹ nhá» nháº¥t.</strong></p>

<p>Má»™t khi chÃºng ta Ä‘Ã£ xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c label vector cho tá»«ng Ä‘iá»ƒm dá»¯ liá»‡u, bÃ i toÃ¡n tÃ¬m center cho má»—i cluster Ä‘Æ°á»£c rÃºt gá»n thÃ nh:</p>

<p>\[
\mathbf{m}_j = \arg\min_{\mathbf{m}_j} \sum_{i = 1}^{N} y_{ij}\|\mathbf{x}_i - \mathbf{m}_j \|_2^2.
\]
 Tá»›i Ä‘Ã¢y, ta cÃ³ thá»ƒ tÃ¬m nghiá»‡m báº±ng phÆ°Æ¡ng phÃ¡p giáº£i Ä‘áº¡o hÃ m báº±ng 0, vÃ¬ hÃ m cáº§n tá»‘i Æ°u lÃ  má»™t hÃ m liÃªn tá»¥c vÃ  cÃ³ Ä‘áº¡o hÃ m xÃ¡c Ä‘á»‹nh táº¡i má»i Ä‘iá»ƒm. <em>VÃ  quan trá»ng hÆ¡n, hÃ m nÃ y lÃ  hÃ m convex (lá»“i) theo \(\mathbf{m}_j \) nÃªn chÃºng ta sáº½ tÃ¬m Ä‘Æ°á»£c giÃ¡ trá»‹ nhá» nháº¥t vÃ  Ä‘iá»ƒm tá»‘i Æ°u tÆ°Æ¡ng á»©ng. Sau nÃ y náº¿u cÃ³ dá»‹p, tÃ´i sáº½ nÃ³i thÃªm vá» tá»‘i Æ°u lá»“i (convex optimization) - má»™t máº£ng cá»±c ká»³ quan trá»ng trong toÃ¡n tá»‘i Æ°u</em>.</p>

<p>Äáº·t \(l(\mathbf{m}_j)\) lÃ  hÃ m bÃªn trong dáº¥u \(\arg\min\), ta cÃ³ Ä‘áº¡o hÃ m:
\[
\frac{\partial l(\mathbf{m}_j)}{\partial \mathbf{m}_j} = 2\sum_{i=1}^N y_{ij}(\mathbf{m}_j - \mathbf{x}_i) 
\]</p>

<p>Giáº£i phÆ°Æ¡ng trÃ¬nh Ä‘áº¡o hÃ m báº±ng 0 ta cÃ³: 
\[
\mathbf{m}_j \sum_{i=1}^N y_{ij} = \sum_{i=1}^N y_{ij} \mathbf{x}_i 
\]
\[
\Rightarrow \mathbf{m}_j = \frac{ \sum_{i=1}^N y_{ij} \mathbf{x}_i}{\sum_{i=1}^N y_{ij}}
\]</p>

<p>Náº¿u Ä‘á»ƒ Ã½ má»™t chÃºt, chÃºng ta sáº½ tháº¥y ráº±ng máº«u sá»‘ chÃ­nh lÃ  phÃ©p Ä‘áº¿m <em>sá»‘ lÆ°á»£ng cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u</em> trong cluster \(j\) (<em>Báº¡n cÃ³ nháº­n ra khÃ´ng?</em>). CÃ²n tá»­ sá»‘ chÃ­nh lÃ  <em>tá»•ng cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u</em> trong cluster \(j\). (<em>Náº¿u báº¡n Ä‘á»c váº«n nhá»› Ä‘iá»u kiá»‡n rÃ ng buá»™c cá»§a cÃ¡c</em> \(y_{ij} \) <em>thÃ¬ sáº½ cÃ³ thá»ƒ nhanh chÃ³ng nhÃ¬n ra Ä‘iá»u nÃ y</em>).</p>

<p>Hay nÃ³i má»™t cÃ¡ch Ä‘Æ¡n giáº£n hÆ¡n nhiá»u: \(\mathbf{m}_j\) <strong>lÃ  trung bÃ¬nh cá»™ng cá»§a cÃ¡c Ä‘iá»ƒm trong cluster</strong> \(j\).</p>

<p>TÃªn gá»i <em>K-means clustering</em> cÅ©ng xuáº¥t phÃ¡t tá»« Ä‘Ã¢y.
<!-- ========================== New Heading ==================== -->
<a name="tom-tat-thuat-toan"></a></p>

<p><a name="tom-tat-thuat-toan"></a></p>
<h3 id="tÃ³m-táº¯t-thuáº­t-toÃ¡n">TÃ³m táº¯t thuáº­t toÃ¡n</h3>
<p>Tá»›i Ä‘Ã¢y tÃ´i xin Ä‘Æ°á»£c tÃ³m táº¯t láº¡i thuáº­t toÃ¡n (<em>Ä‘áº·c biá»‡t quan trá»ng vá»›i cÃ¡c báº¡n bá» qua pháº§n toÃ¡n há»c bÃªn trÃªn</em>) nhÆ° sau:</p>

<p><strong>Äáº§u vÃ o:</strong> Dá»¯ liá»‡u \(\mathbf{X}\) vÃ  sá»‘ lÆ°á»£ng cluster cáº§n tÃ¬m \(K\).</p>

<p><strong>Äáº§u ra:</strong> CÃ¡c center \(\mathbf{M}\) vÃ  label vector cho tá»«ng Ä‘iá»ƒm dá»¯ liá»‡u \(\mathbf{Y}\).</p>

<ol>
  <li>Chá»n \(K\) Ä‘iá»ƒm báº¥t ká»³ lÃ m cÃ¡c center ban Ä‘áº§u.</li>
  <li>PhÃ¢n má»—i Ä‘iá»ƒm dá»¯ liá»‡u vÃ o cluster cÃ³ center gáº§n nÃ³ nháº¥t.</li>
  <li>Náº¿u viá»‡c gÃ¡n dá»¯ liá»‡u vÃ o tá»«ng cluster á»Ÿ bÆ°á»›c 2 khÃ´ng thay Ä‘á»•i so vá»›i vÃ²ng láº·p trÆ°á»›c nÃ³ thÃ¬ ta dá»«ng thuáº­t toÃ¡n.</li>
  <li>Cáº­p nháº­t center cho tá»«ng cluster báº±ng cÃ¡ch láº¥y trung bÃ¬nh cá»™ng cá»§a táº¥t cÃ¡c cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c gÃ¡n vÃ o cluster Ä‘Ã³ sau bÆ°á»›c 2.</li>
  <li>Quay láº¡i bÆ°á»›c 2.</li>
</ol>

<p>ChÃºng ta cÃ³ thá»ƒ Ä‘áº£m báº£o ráº±ng thuáº­t toÃ¡n sáº½ dá»«ng láº¡i sau má»™t sá»‘ há»¯u háº¡n vÃ²ng láº·p. Tháº­t váº­y, vÃ¬ hÃ m máº¥t mÃ¡t lÃ  má»™t sá»‘ dÆ°Æ¡ng vÃ  sau má»—i bÆ°á»›c 2 hoáº·c 3, giÃ¡ trá»‹ cá»§a hÃ m máº¥t mÃ¡t bá»‹ giáº£m Ä‘i. Theo kiáº¿n thá»©c vá» dÃ£y sá»‘ trong chÆ°Æ¡ng trÃ¬nh cáº¥p 3: <em>náº¿u má»™t dÃ£y sá»‘ giáº£m vÃ  bá»‹ cháº·n dÆ°á»›i thÃ¬ nÃ³ há»™i tá»¥!</em> HÆ¡n ná»¯a, sá»‘ lÆ°á»£ng cÃ¡ch phÃ¢n nhÃ³m cho toÃ n bá»™ dá»¯ liá»‡u lÃ  há»¯u háº¡n nÃªn Ä‘áº¿n má»™t lÃºc nÃ o Ä‘Ã³, hÃ m máº¥t mÃ¡t sáº½ khÃ´ng thá»ƒ thay Ä‘á»•i, vÃ  chÃºng ta cÃ³ thá»ƒ dá»«ng thuáº­t toÃ¡n táº¡i Ä‘Ã¢y.</p>

<p>ChÃºng ta sáº½ cÃ³ má»™t vÃ i <a href="#-thao-luan">tháº£o luáº­n</a> vá» thuáº­t toÃ¡n nÃ y, vá» nhá»¯ng háº¡n cháº¿ vÃ  má»™t sá»‘ phÆ°Æ¡ng phÃ¡p kháº¯c phá»¥c. NhÆ°ng trÆ°á»›c háº¿t, hÃ£y xem nÃ³ thá»ƒ hiá»‡n nhÆ° tháº¿ nÃ o trong má»™t vÃ­ dá»¥ cá»¥ thá»ƒ dÆ°á»›i Ä‘Ã¢y.</p>

<!-- ========================== New Heading ==================== -->
<p><a name="-vi-du-tren-python"></a></p>

<h2 id="3-vÃ­-dá»¥-trÃªn-python">3. VÃ­ dá»¥ trÃªn Python</h2>

<!-- ========================== New Heading ==================== -->
<p><a name="gioi-thieu-bai-toan"></a></p>

<h3 id="giá»›i-thiá»‡u-bÃ i-toÃ¡n">Giá»›i thiá»‡u bÃ i toÃ¡n</h3>

<p>Äá»ƒ kiá»ƒm tra má»©c Ä‘á»™ hiá»ƒu quáº£ cá»§a má»™t thuáº­t toÃ¡n, chÃºng ta sáº½ lÃ m má»™t vÃ­ dá»¥ Ä‘Æ¡n giáº£n (thÆ°á»ng Ä‘Æ°á»£c gá»i lÃ  <em>toy example</em>). TrÆ°á»›c háº¿t, chÃºng ta chá»n center cho tá»«ng cluster vÃ  táº¡o dá»¯ liá»‡u cho tá»«ng cluster báº±ng cÃ¡ch láº¥y máº«u theo phÃ¢n phá»‘i chuáº©n cÃ³ ká»³ vá»ng lÃ  center cá»§a cluster Ä‘Ã³ vÃ  ma tráº­n hiá»‡p phÆ°Æ¡ng sai (covariance matrix) lÃ  ma tráº­n Ä‘Æ¡n vá»‹.</p>

<p>TrÆ°á»›c tiÃªn, chÃºng ta cáº§n khai bÃ¡o cÃ¡c thÆ° viá»‡n cáº§n dÃ¹ng. ChÃºng ta cáº§n <code class="language-plaintext highlighter-rouge">numpy</code> vÃ  <code class="language-plaintext highlighter-rouge">matplotlib</code> nhÆ° trong bÃ i <a href="/2016/12/28/linearregression/">Linear Regression</a> cho viá»‡c tÃ­nh toÃ¡n ma tráº­n vÃ  hiá»ƒn thá»‹ dá»¯ liá»‡u. ChÃºng ta cÅ©ng cáº§n thÃªm thÆ° viá»‡n <code class="language-plaintext highlighter-rouge">scipy.spatial.distance</code> Ä‘á»ƒ tÃ­nh khoáº£ng cÃ¡ch giá»¯a cÃ¡c cáº·p Ä‘iá»ƒm trong hai táº­p há»£p má»™t cÃ¡ch hiá»‡u quáº£.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span> 
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">cdist</span>
<span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
</code></pre></div></div>

<p>Tiáº¿p theo, ta táº¡o dá»¯ liá»‡u báº±ng cÃ¡ch láº¥y cÃ¡c Ä‘iá»ƒm theo phÃ¢n phá»‘i chuáº©n cÃ³ ká»³ vá»ng táº¡i cÃ¡c Ä‘iá»ƒm cÃ³ tá»a Ä‘á»™ <code class="language-plaintext highlighter-rouge">(2, 2), (8, 3)</code> vÃ  <code class="language-plaintext highlighter-rouge">(3, 6)</code>, ma tráº­n hiá»‡p phÆ°Æ¡ng sai giá»‘ng nhau vÃ  lÃ  ma tráº­n Ä‘Æ¡n vá»‹. Má»—i cluster cÃ³ 500 Ä‘iá»ƒm. (<em>ChÃº Ã½ ráº±ng má»—i Ä‘iá»ƒm dá»¯ liá»‡u lÃ  má»™t hÃ ng cá»§a ma tráº­n dá»¯ liá»‡u.</em></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">means</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]</span>
<span class="n">cov</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">X0</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">means</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cov</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="n">X1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">means</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cov</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="n">X2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">means</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">cov</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X0</span><span class="p">,</span> <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">),</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">K</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">original_label</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">N</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">N</span> <span class="o">+</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">N</span><span class="p">).</span><span class="n">T</span>
</code></pre></div></div>

<!-- ========================== New Heading ==================== -->
<p><a name="hien-thi-du-lieu-tren-do-thi"></a></p>

<h3 id="hiá»ƒn-thá»‹-dá»¯-liá»‡u-trÃªn-Ä‘á»“-thá»‹">Hiá»ƒn thá»‹ dá»¯ liá»‡u trÃªn Ä‘á»“ thá»‹</h3>

<p>ChÃºng ta cáº§n má»™t hÃ m <code class="language-plaintext highlighter-rouge">kmeans_display</code> Ä‘á»ƒ hiá»ƒn thá»‹ dá»¯ liá»‡u. Sau Ä‘Ã³ hiá»ƒn thá»‹ dá»¯ liá»‡u theo nhÃ£n ban Ä‘áº§u.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">kmeans_display</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
    <span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">amax</span><span class="p">(</span><span class="n">label</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">X0</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">label</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">X1</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">label</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">X2</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">label</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
    
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X0</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X0</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s">'b^'</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="p">.</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X1</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X1</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s">'go'</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="p">.</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X2</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s">'rs'</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="p">.</span><span class="mi">8</span><span class="p">)</span>

    <span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">(</span><span class="s">'equal'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">()</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
    
<span class="n">kmeans_display</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">original_label</span><span class="p">)</span>
</code></pre></div></div>

<!-- ![png](output_5_0.png) -->
<div class="imgcap">
<img src="/assets/kmeans/output_5_0.png" align="center" />
</div>
<p>Trong Ä‘á»“ thá»‹ trÃªn, má»—i cluster tÆ°Æ¡ng á»©ng vá»›i má»™t mÃ u. CÃ³ thá»ƒ nháº­n tháº¥y ráº±ng cÃ³ má»™t vÃ i Ä‘iá»ƒm mÃ u Ä‘á» bá»‹ láº«n sang pháº§n cluster mÃ u xanh.
<!-- ========================== New Heading ==================== -->
<a name="cac-ham-so-can-thiet-cho-k-means-clustering"></a></p>

<p><a name="cac-ham-so-can-thiet-cho-k-means-clustering"></a></p>
<h3 id="cÃ¡c-hÃ m-sá»‘-cáº§n-thiáº¿t-cho-k-means-clustering">CÃ¡c hÃ m sá»‘ cáº§n thiáº¿t cho K-means clustering</h3>
<p>Viáº¿t cÃ¡c hÃ m:</p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">kmeans_init_centers</code> Ä‘á»ƒ khá»Ÿi táº¡o cÃ¡c centers ban Ä‘áº§u.</li>
  <li><code class="language-plaintext highlighter-rouge">kmeans_asign_labels</code> Ä‘á»ƒ gÃ¡n nhÃ¡n má»›i cho cÃ¡c Ä‘iá»ƒm khi biáº¿t cÃ¡c centers.</li>
  <li><code class="language-plaintext highlighter-rouge">kmeans_update_centers</code> Ä‘á»ƒ cáº­p nháº­t cÃ¡c centers má»›i dá»¯a trÃªn dá»¯ liá»‡u vá»«a Ä‘Æ°á»£c gÃ¡n nhÃ£n.</li>
  <li><code class="language-plaintext highlighter-rouge">has_converged</code> Ä‘á»ƒ kiá»ƒm tra Ä‘iá»u kiá»‡n dá»«ng cá»§a thuáº­t toÃ¡n.</li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">kmeans_init_centers</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="c1"># randomly pick k rows of X as initial centers
</span>    <span class="k">return</span> <span class="n">X</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">k</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="bp">False</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">kmeans_assign_labels</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centers</span><span class="p">):</span>
    <span class="c1"># calculate pairwise distances btw data and centers
</span>    <span class="n">D</span> <span class="o">=</span> <span class="n">cdist</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
    <span class="c1"># return index of the closest center
</span>    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">kmeans_update_centers</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">K</span><span class="p">):</span>
    <span class="n">centers</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">K</span><span class="p">,</span> <span class="n">X</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
        <span class="c1"># collect all points assigned to the k-th cluster 
</span>        <span class="n">Xk</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="n">k</span><span class="p">,</span> <span class="p">:]</span>
        <span class="c1"># take average
</span>        <span class="n">centers</span><span class="p">[</span><span class="n">k</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Xk</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">centers</span>

<span class="k">def</span> <span class="nf">has_converged</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">new_centers</span><span class="p">):</span>
    <span class="c1"># return True if two sets of centers are the same
</span>    <span class="k">return</span> <span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="nb">tuple</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">centers</span><span class="p">])</span> <span class="o">==</span> 
        <span class="nb">set</span><span class="p">([</span><span class="nb">tuple</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">new_centers</span><span class="p">]))</span>
</code></pre></div></div>

<p>Pháº§n chÃ­nh cá»§a K-means clustering:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">kmeans</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">K</span><span class="p">):</span>
    <span class="n">centers</span> <span class="o">=</span> <span class="p">[</span><span class="n">kmeans_init_centers</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">K</span><span class="p">)]</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">it</span> <span class="o">=</span> <span class="mi">0</span> 
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">labels</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">kmeans_assign_labels</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">new_centers</span> <span class="o">=</span> <span class="n">kmeans_update_centers</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">K</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">has_converged</span><span class="p">(</span><span class="n">centers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">new_centers</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="n">centers</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_centers</span><span class="p">)</span>
        <span class="n">it</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">it</span><span class="p">)</span>
</code></pre></div></div>

<p>Ãp dá»¥ng thuáº­t toÃ¡n vá»«a viáº¿t vÃ o dá»¯ liá»‡u ban Ä‘áº§u, hiá»ƒn thá»‹ káº¿t quáº£ cuá»‘i cÃ¹ng.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">it</span><span class="p">)</span> <span class="o">=</span> <span class="n">kmeans</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Centers found by our algorithm:'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">centers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="n">kmeans_display</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Centers found by our algorithm:
[[ 1.97563391  2.01568065]
 [ 8.03643517  3.02468432]
 [ 2.99084705  6.04196062]]
</code></pre></div></div>

<div class="imgcap">
<img src="/assets/kmeans/output_11_1.png" align="center" />
</div>

<!-- ![png](output_11_1.png) -->

<p>Tá»« káº¿t quáº£ nÃ y chÃºng ta tháº¥y ráº±ng thuáº­t toÃ¡n K-means clustering lÃ m viá»‡c khÃ¡ thÃ nh cÃ´ng, cÃ¡c centers tÃ¬m Ä‘Æ°á»£c khÃ¡ gáº§n vá»›i ká»³ vá»ng ban Ä‘áº§u. CÃ¡c Ä‘iá»ƒm thuá»™c cÃ¹ng má»™t cluster háº§u nhÆ° Ä‘Æ°á»£c phÃ¢n vÃ o cÃ¹ng má»™t cluster (trá»« má»™t sá»‘ diá»ƒm mÃ u Ä‘á» ban Ä‘áº§u Ä‘Ã£ bá»‹ phÃ¢n nháº§m vÃ o cluster mÃ u xanh da trá»i, nhÆ°ng tá»‰ lá»‡ lÃ  nhá» vÃ  cÃ³ thá»ƒ cháº¥p nháº­n Ä‘Æ°á»£c).</p>

<p>DÆ°á»›i Ä‘Ã¢y lÃ  hÃ¬nh áº£nh Ä‘á»™ng minh há»a thuáº­t toÃ¡n qua tá»«ng vÃ²ng láº·p, chÃºng ta tháº¥y ráº±ng thuáº­t toÃ¡n trÃªn há»™i tá»¥ ráº¥t nhanh, chá»‰ cáº§n 6 vÃ²ng láº·p Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c káº¿t quáº£ cuá»‘i cÃ¹ng:</p>
<div class="imgcap">
<img src="/assets/kmeans/kmeans11.gif" align="center" />
</div>

<p>CÃ¡c báº¡n cÃ³ thá»ƒ xem thÃªm cÃ¡c trang web minh há»a thuáº­t toÃ¡n K-means cluster táº¡i:</p>
<ol>
  <li><a href="https://www.naftaliharris.com/blog/visualizing-k-means-clustering/">Visualizing K-Means Clustering</a></li>
  <li><a href="http://stanford.edu/class/ee103/visualizations/kmeans/kmeans.html">Visualizing K-Means Clustering - Standford</a></li>
</ol>

<!-- ========================== New Heading ==================== -->
<p><a name="ket-qua-tim-duoc-bang-thu-vien-scikit-learn"></a></p>

<p><a name="ket-qua-tim-duoc-bang-thu-vien-scikit-learn"></a></p>
<h3 id="káº¿t-quáº£-tÃ¬m-Ä‘Æ°á»£c-báº±ng-thÆ°-viá»‡n-scikit-learn">Káº¿t quáº£ tÃ¬m Ä‘Æ°á»£c báº±ng thÆ° viá»‡n scikit-learn</h3>

<p>Äá»ƒ kiá»ƒm tra thÃªm, chÃºng ta hÃ£y so sÃ¡nh káº¿t quáº£ trÃªn vá»›i káº¿t quáº£ thu Ä‘Æ°á»£c báº±ng cÃ¡ch sá»­ dá»¥ng thÆ° viá»‡n <a href="http://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html"><code class="language-plaintext highlighter-rouge">scikit-learn</code></a>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">).</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Centers found by scikit-learn:'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">kmeans</span><span class="p">.</span><span class="n">cluster_centers_</span><span class="p">)</span>
<span class="n">pred_label</span> <span class="o">=</span> <span class="n">kmeans</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">kmeans_display</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">pred_label</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Centers found by scikit-learn:
[[ 8.0410628   3.02094748]
 [ 2.99357611  6.03605255]
 [ 1.97634981  2.01123694]]
</code></pre></div></div>

<!-- ![png](output_14_1.png) -->
<div class="imgcap">
<img src="/assets/kmeans/output_14_1.png" align="center" />
</div>

<p>Tháº­t may máº¯n (<em>cho tÃ´i</em>), hai thuáº­t toÃ¡n cho cÃ¹ng má»™t Ä‘Ã¡p sá»‘! Vá»›i cÃ¡ch thá»© nháº¥t, tÃ´i mong muá»‘n cÃ¡c báº¡n hiá»ƒu rÃµ Ä‘Æ°á»£c thuáº­t toÃ¡n K-means clustering lÃ m viá»‡c nhÆ° tháº¿ nÃ o. Vá»›i cÃ¡ch thá»© hai, tÃ´i hy vá»ng cÃ¡c báº¡n biáº¿t Ã¡p dá»¥ng thÆ° viá»‡n sáºµn cÃ³ nhÆ° tháº¿ nÃ o.</p>

<!-- ========================== New Heading ==================== -->
<p><a name="-thao-luan"></a></p>

<h2 id="4-tháº£o-luáº­n">4. Tháº£o luáº­n</h2>
<!-- ========================== New Heading ==================== -->
<p><a name="han-che"></a></p>

<h3 id="háº¡n-cháº¿">Háº¡n cháº¿</h3>
<p>CÃ³ má»™t vÃ i háº¡n cháº¿ cá»§a thuáº­t toÃ¡n K-means clustering:</p>

<!-- ========================== New Heading ==================== -->
<p><a name="chung-ta-can-biet-so-luong-cluster-can-clustering"></a></p>

<h4 id="chÃºng-ta-cáº§n-biáº¿t-sá»‘-lÆ°á»£ng-cluster-cáº§n-clustering">ChÃºng ta cáº§n biáº¿t sá»‘ lÆ°á»£ng cluster cáº§n clustering</h4>
<p>Äá»ƒ Ã½ tháº¥y ráº±ng trong <a href="#tom-tat-thuat-toan">thuáº­t toÃ¡n nÃªu trÃªn</a>, chÃºng ta cáº§n biáº¿t Ä‘áº¡i lÆ°á»£ng \(K\) lÃ  sá»‘ lÆ°á»£ng clusters. Trong thá»±c táº¿, nhiá»u trÆ°á»ng há»£p chÃºng ta khÃ´ng xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c giÃ¡ trá»‹ nÃ y. CÃ³ má»™t sá»‘ phÆ°Æ¡ng phÃ¡p giÃºp xÃ¡c Ä‘á»‹nh sá»‘ lÆ°á»£ng clusters, tÃ´i sáº½ dÃ nh thá»i gian nÃ³i vá» chÃºng sau náº¿u cÃ³ dá»‹p. Báº¡n Ä‘á»c cÃ³ thá»ƒ tham kháº£o <a href="https://en.wikipedia.org/wiki/Determining_the_number_of_clusters_in_a_data_set">Elbow method - Determining the number of clusters in a data set</a>.</p>

<!-- ========================== New Heading ==================== -->
<p><a name="nghiem-cuoi-cung-phu-thuoc-vao-cac-centers-duoc-khoi-tao-ban-dau"></a></p>

<h4 id="nghiá»‡m-cuá»‘i-cÃ¹ng-phá»¥-thuá»™c-vÃ o-cÃ¡c-centers-Ä‘Æ°á»£c-khá»Ÿi-táº¡o-ban-Ä‘áº§u">Nghiá»‡m cuá»‘i cÃ¹ng phá»¥ thuá»™c vÃ o cÃ¡c centers Ä‘Æ°á»£c khá»Ÿi táº¡o ban Ä‘áº§u</h4>
<p>TÃ¹y vÃ o cÃ¡c center ban Ä‘áº§u mÃ  thuáº­t toÃ¡n cÃ³ thá»ƒ cÃ³ tá»‘c Ä‘á»™ há»™i tá»¥ ráº¥t cháº­m, vÃ­ dá»¥:
<!-- ![png](output_14_1.png) --></p>
<div class="imgcap">
<img src="/assets/kmeans/kmeans_slowconverge.gif" align="center" />
</div>
<p>hoáº·c tháº­m chÃ­ cho chÃºng ta nghiá»‡m khÃ´ng chÃ­nh xÃ¡c (chá»‰ lÃ  local minimum - Ä‘iá»ƒm cá»±c tiá»ƒu - mÃ  khÃ´ng pháº£i giÃ¡ trá»‹ nhá» nháº¥t):</p>

<div class="imgcap">
<img src="/assets/kmeans/kmeans_badresult.gif" align="center" />
</div>

<p>CÃ³ má»™t vÃ i cÃ¡ch kháº¯c phá»¥c Ä‘Ã³ lÃ :</p>

<ul>
  <li>
    <p>Cháº¡y K-means clustering nhiá»u láº§n vá»›i cÃ¡c center ban Ä‘áº§u khÃ¡c nhau rá»“i chá»n cÃ¡ch cÃ³ hÃ m máº¥t mÃ¡t cuá»‘i cÃ¹ng Ä‘áº¡t giÃ¡ trá»‹ nhá» nháº¥t.</p>
  </li>
  <li>
    <p><a href="https://en.wikipedia.org/wiki/K-means%2B%2B#Improved_initialization_algorithm">K-means++ -Improve initialization algorithm - wiki</a>.</p>
  </li>
  <li>
    <p>Báº¡n nÃ o muá»‘n tÃ¬m hiá»ƒu sÃ¢u hÆ¡n cÃ³ thá»ƒ xem bÃ i bÃ¡o khoa há»c <a href="http://www.sciencedirect.com/science/article/pii/S0167865504000996">Cluster center initialization algorithm for K-means clustering</a>.</p>
  </li>
</ul>

<!-- ========================== New Heading ==================== -->
<p><a name="cac-cluster-can-co-so-luong-diem-gan-bang-nhau"></a></p>

<h4 id="cÃ¡c-cluster-cáº§n-cÃ³-sÃ³-lÆ°á»£ng-Ä‘iá»ƒm-gáº§n-báº±ng-nhau">CÃ¡c cluster cáº§n cÃ³ sÃ³ lÆ°á»£ng Ä‘iá»ƒm gáº§n báº±ng nhau</h4>

<p>DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ vá»›i 3 cluster vá»›i 20, 50, vÃ  1000 Ä‘iá»ƒm. Káº¿t quáº£ cuá»‘i cÃ¹ng khÃ´ng chÃ­nh xÃ¡c.</p>

<div class="imgcap">
<img src="/assets/kmeans/kmeans_unbalanced.gif" align="center" />
</div>

<!-- ========================== New Heading ==================== -->
<p><a name="cac-cluster-can-co-dang-hinh-tron"></a></p>

<h4 id="cÃ¡c-cluster-cáº§n-cÃ³-dáº¡ng-hÃ¬nh-trÃ²n">CÃ¡c cluster cáº§n cÃ³ dáº¡ng hÃ¬nh trÃ²n</h4>
<p>Tá»©c cÃ¡c cluster tuÃ¢n theo phÃ¢n phá»‘i chuáº©n vÃ  ma tráº­n hiá»‡p phÆ°Æ¡ng sai lÃ  ma tráº­n Ä‘Æ°á»ng chÃ©o cÃ³ cÃ¡c Ä‘iá»ƒm trÃªn Ä‘Æ°á»ng chÃ©o giá»‘ng nhau.</p>

<p>DÆ°á»›i Ä‘Ã¢y lÃ  1 vÃ­ dá»¥ khi 1 cluster cÃ³ dáº¡ng hÃ¬nh dáº¹t.</p>

<div class="imgcap">
<img src="/assets/kmeans/kmeans_diffcov.gif" align="center" />
</div>

<!-- ========================== New Heading ==================== -->
<p><a name="khi-mot-cluster-nam-phia-trong--cluster-khac"></a></p>

<h4 id="khi-má»™t-cluster-náº±m-phÃ­a-trong-1-cluster-khÃ¡c">Khi má»™t cluster náº±m phÃ­a trong 1 cluster khÃ¡c</h4>
<p>ÄÃ¢y lÃ  vÃ­ dá»¥ kinh Ä‘iá»ƒn vá» viá»‡c K-means clustering khÃ´ng thá»ƒ phÃ¢n cá»¥m dá»¯ liá»‡u. Má»™t cÃ¡ch tá»± nhiÃªn, chÃºng ta sáº½ phÃ¢n ra thÃ nh 4 cá»¥m: máº¯t trÃ¡i, máº¯t pháº£i, miá»‡ng, xunh quanh máº·t. NhÆ°ng vÃ¬ máº¯t vÃ  miá»‡ng náº±m trong khuÃ´n máº·t nÃªn K-means clustering khÃ´ng thá»±c hiá»‡n Ä‘Æ°á»£c:</p>

<div class="imgcap">
<img src="/assets/kmeans/smile_face.png" align="center" />
</div>
<!-- ========================== New Heading ==================== -->
<p><a name="-tai-lieu-tham-khao"></a></p>

<!-- ### Khoáº£ng cÃ¡ch khÃ´ng pháº£i Euclid -->
<!-- Trong nhiá»u trÆ°á»ng há»£p, chÃºng ta cÃ³ thá»ƒ Ä‘á»‹nh -->

<p>Máº·c dÃ¹ cÃ³ nhá»¯ng háº¡n cháº¿, K-means clustering váº«n cá»±c ká»³ quan trá»ng trong Machine Learning vÃ  lÃ  ná»n táº£ng cho nhiá»u thuáº­t toÃ¡n phá»©c táº¡p khÃ¡c sau nÃ y. ChÃºng ta cáº§n báº¯t Ä‘áº§u tá»« nhá»¯ng thá»© Ä‘Æ¡n giáº£n. <em>Simple is best!</em></p>

<!-- ========================== New Heading ==================== -->
<p><a name="-tai-lieu-tham-khao"></a></p>

<h2 id="5-tÃ i-liá»‡u-tham-kháº£o">5. TÃ i liá»‡u tham kháº£o</h2>

<p><a href="http://scikit-learn.org/stable/auto_examples/text/document_clustering.html">Clustering documents using k-means</a></p>

<p><a href="https://en.wikipedia.org/wiki/Voronoi_diagram">Voronoi Diagram - Wikipedia</a></p>

<p><a href="http://www.sciencedirect.com/science/article/pii/S0167865504000996">Cluster center initialization algorithm for K-means clustering</a></p>

<p><a href="https://www.naftaliharris.com/blog/visualizing-k-means-clustering/">Visualizing K-Means Clustering</a></p>

<p><a href="http://stanford.edu/class/ee103/visualizations/kmeans/kmeans.html">Visualizing K-Means Clustering - Standford</a></p>

:ET